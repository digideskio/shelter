<!doctype html>
<!-- The Time Machine GitHub pages theme was designed and developed by Jon Rohan, on Feb 7, 2012. -->
<!-- Follow him for fun. http://twitter.com/jonrohan. Tail his code on http://github.com/jonrohan -->
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <link rel="stylesheet" href="stylesheets/stylesheet.css" media="screen"/>
  <link rel="stylesheet" href="stylesheets/pygment_trac.css"/>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script type="text/javascript" src="javascripts/script.js"></script>

  <title>Shelter</title>
  <meta name="description" content="Program to periodically validate and alert domains about DNS or DNSSEC misconfiguration">

  <meta name="viewport" content="width=device-width,initial-scale=1">

</head>

<body>

  <div class="wrapper">
    <header>
      <h1 class="title">Shelter</h1>
    </header>
    <div id="container">
      <p class="tagline">Program to periodically validate and alert domains about DNS or DNSSEC misconfiguration</p>
      <div id="main" role="main">
        <div class="download-bar">
        <div class="inner">
          <a href="https://github.com/rafaeljusto/shelter/tarball/master" class="download-button tar"><span>Download</span></a>
          <a href="https://github.com/rafaeljusto/shelter/zipball/master" class="download-button zip"><span>Download</span></a>
          <a href="https://github.com/rafaeljusto/shelter" class="code">View Shelter on GitHub</a>
        </div>
        <span class="blc"></span><span class="trc"></span>
        </div>
        <article class="markdown-body">
          <h1>
<a name="shelter" class="anchor" href="#shelter"><span class="octicon octicon-link"></span></a>shelter</h1>

<p>Program created for registries to periodically validate and alert domains about DNS or
DNSSEC misconfiguration</p>

<h1>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>installation</h1>

<p>Shelter project depends on the following packages:</p>

<ul>
<li>labix.org/v2/mgo</li>
<li>github.com/miekg/dns</li>
</ul><p>All the above packages can be installed using the command:</p>

<pre><code>go get &lt;package_name&gt;
</code></pre>

<p>All system objects are persisted using a MongoDB database, this NoSQL database was choosen
because we can embed dependency objects, and avoid table relations in a relational
database scenario. Without the relations the code is cleaner and the database I/O is
faster. To install it check the webpage <a href="http://www.mongodb.org/">http://www.mongodb.org/</a></p>

<h1>
<a name="performance" class="anchor" href="#performance"><span class="octicon octicon-link"></span></a>performance</h1>

<p>The domain persistence performance is listed in the table bellow, where "#" represents the
number of domains used in the operation. Each line was executed 5 times to calculate the
average time. Also, the "find" operation represents 3 object searchs in differents parts
of the range. For this results we are using 1000 concurrent agents (go routines) for
insert and remove operations, in an Intel Core i7-2600 3.40GHz with 8GiB of memory, using
the Ubuntu 12.10 (amd64) operational system.</p>

<pre><code> #       | Total           | Insert          | Find         | Remove
-----------------------------------------------------------------------------
 10      |      3.513014ms |      1.442383ms |    558.179us |      1.512109ms
 50      |      7.421929ms |      3.566502ms |    423.251us |      3.431936ms
 100     |     11.027912ms |      4.701412ms |    420.808us |      5.905437ms
 500     |      51.31504ms |     25.217248ms |     799.99us |     25.297463ms
 1000    |     96.370863ms |     46.482595ms |    1.00416ms |     48.883654ms
 5000    |      503.0236ms |    228.404845ms |   1.026406ms |    273.591873ms
 10000   |    1.026367147s |    484.794695ms |   1.475828ms |    540.096072ms
 50000   |    5.030043687s |    2.260250365s |  36.661348ms |    2.733131384s
 100000  |   10.211076193s |    4.500565689s |  36.303439ms |    5.674206572s
 500000  |    56.49850228s |   26.533725121s | 268.502266ms |   29.696274265s
 1000000 | 1m53.999031752s |   52.733993985s | 489.089955ms |  1m0.775947206s
 5000000 | 9m41.845527592s | 4m28.462709335s | 1.976624332s | 5m11.406193319s
</code></pre>

<p>Now the network layer that is responsable for sending, receiveing and analyzing the DNS
packages had the performance shown in the table bellow, where "#" represents the number of
domains used in the round of checks and QPS is the number of requests per second that the
system could process. For this results were used 400 concurrent queriers (go routines)
each one with an input wait list that can store 100 domains. The hardware used was an
Intel Core i7-2600 3.40GHz with 8GiB of memory, using the Ubuntu 12.10 (amd64) operational
system. All the requests were sent to a local DNS server.</p>

<pre><code> #       | Total            | QPS  | Memory (MB)
-----------------------------------------------------
 10      |       2.817312ms |   10 |           1.08
 50      |      14.766817ms |   50 |           1.24
 100     |      25.443762ms |  100 |           1.91
 500     |     1.059420731s |  500 |           4.31
 1000    |     1.054760148s | 1000 |           4.31
 5000    |     2.060903121s | 2500 |           8.07
 10000   |     5.402801345s | 2000 |           9.50
 50000   |    25.349122233s | 2000 |          24.69
 100000  |    49.294494104s | 2040 |          50.19
 500000  |   4m1.158914516s | 2074 |         390.90
 1000000 |  8m16.682795099s | 2016 |         488.53
 5000000 | 42m22.573865695s | 1966 |        4182.01
</code></pre>

<p>Bellow is the same test but for the root zone file.</p>

<pre><code> #       | Total            | QPS  | Memory (MB)
---------------------------------------------------
 341     |     7.154577009s |   48 |          12.18

Nameserver Status
-----------------
              OK:  92.45%
              UH:  0.16%
        QREFUSED:  0.05%
        NOTSYNCH:  5.11%
        SERVFAIL:  0.11%
            NOAA:  0.05%
         TIMEOUT:  1.63%
        CREFUSED:  0.16%
           ERROR:  0.27%

DS Status
---------
              OK:  82.50%
          SIGERR:  4.50%
           NOSIG:  5.50%
         TIMEOUT:  5.50%
           NOKEY:  2.00%
</code></pre>
        </article>
      </div>
    </div>
    <footer>
      <div class="owner">
      <p><a href="https://github.com/rafaeljusto" class="avatar"><img src="https://1.gravatar.com/avatar/7a981c7699ff90c283293ad941551625?d=https%3A%2F%2Fidenticons.github.com%2Ffd7267d876605fc274634160aec2f113.png&amp;r=x&amp;s=60" width="48" height="48"/></a> <a href="https://github.com/rafaeljusto">rafaeljusto</a> maintains <a href="https://github.com/rafaeljusto/shelter">Shelter</a></p>


      </div>
      <div class="creds">
        <small>This page generated using <a href="http://pages.github.com/">GitHub Pages</a><br/>theme by <a href="https://twitter.com/jonrohan/">Jon Rohan</a></small>
      </div>
    </footer>
  </div>
  <div class="current-section">
    <a href="#top">Scroll to top</a>
    <a href="https://github.com/rafaeljusto/shelter/tarball/master" class="tar">tar</a><a href="https://github.com/rafaeljusto/shelter/zipball/master" class="zip">zip</a><a href="" class="code">source code</a>
    <p class="name"></p>
  </div>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-46641878-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

</body>
</html>
